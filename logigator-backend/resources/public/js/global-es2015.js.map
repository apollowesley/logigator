{"version":3,"sources":["global-es2015.js","global.js","bem.js","global-functions.js"],"names":["siteHeaderPartial","node","settingsDropdown","querySelector","dropdownBackground","Bem","element","dropdownOpen","addEventListener","setState","setBurgerMenuState","popupPartial","opened","hasState","dataTriggers","data","split","forEach","trigger","document","elements","elem","burgerMenuBackgroundElement","formValidationForGlobalForms","form","startFormValidation","cookieConsent","cookie","style","display","window","bemClass","classList","length","i","includes","concat","querySelectorAll","state","active","add","remove","contains","toggleState","toggle","hasModifier","modifier","getAttribute","hasData","hasAttribute","open","burgerMenuButton","burgerMenu","burgerMenuBackground","undefined","debounceFunction","func","debounce","timeout","context","this","args","arguments","later","apply","clearTimeout","setTimeout","formElement","validationFunctions","isNotEmpty","value","minLength","valData","Number","maxLength","isEmail","test","matches","RegExp","matchesProperty","namedItem","mustChange","submitButton","formElements","formErrorConfig","config","HTMLButtonElement","formContainer","closest","elementConfig","touched","valid","errors","errorMessages","children","errorMessage","errorName","push","generateFormErrorConfig","elementErrorConfig","updateElementState","defaultInvalid","error","isValid","disabled","every","elemErrConf","openDynamicPopup","async","popupUrl","insertionPoint","resp","fetch","innerHTML","text","setupPopupHandling","popupElem","firstChild","removeChild","lastChild","_event$submitter$getA","event","preventDefault","submitter","submitResp","action","method","headers","Content-Type","redirect","body","URLSearchParams","FormData","redirected","location","reload","autoAdjustFontSize","contextToCheck","desiredFontWidth","getComputedStyle","originalWidth","fontSize","replace","adjustedWidth","font","__autoFontSizeCanvas__","createElement","context2D","getContext","measureText","width","getTextWidth","innerText","popup"],"mappings":"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","file":"global-es2015.js","sourcesContent":[null,"// PARTIALS ---------------------------------------------------------------------------------------\n\n/**\n * @param {HTMLElement} node\n */\nfunction siteHeaderPartial(node) {\n\tconst settingsDropdown = node.querySelector('.partial-settings-dropdown');\n\tconst dropdownBackground = Bem.element(node, 'dropdown-background');\n\n\tlet dropdownOpen = false;\n\tBem.element(node, 'dropdown-trigger').addEventListener('click', () => {\n\t\tdropdownOpen = !dropdownOpen;\n\t\tBem.setState(settingsDropdown, 'open', dropdownOpen);\n\t\tBem.setState(dropdownBackground, 'shown', dropdownOpen);\n\t});\n\n\tdropdownBackground.addEventListener('click', () => {\n\t\tdropdownOpen = false;\n\t\tBem.setState(settingsDropdown, 'open', dropdownOpen);\n\t\tBem.setState(dropdownBackground, 'shown', dropdownOpen);\n\t});\n\n\tBem.element(node, 'burger-menu').addEventListener('click', () => setBurgerMenuState());\n}\nsiteHeaderPartial(document.querySelector('.partial-site-header'));\n\n// ------------------------------------------------------------------------------------------------\n\n/**\n * @param {HTMLElement} node\n */\nfunction popupPartial(node) {\n\tlet opened = Bem.hasState(node, 'open');\n\n\tconst dataTriggers = Bem.data(node, 'triggers');\n\n\tif (dataTriggers) {\n\t\tconst triggers = dataTriggers.split('::');\n\t\ttriggers.forEach(trigger => {\n\t\t\tdocument.querySelector(trigger).addEventListener('click', () => {\n\t\t\t\tif (!opened) {\n\t\t\t\t\tBem.setState(node, 'open', true);\n\t\t\t\t\topened = true;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tBem.elements(node, 'close').forEach(elem => {\n\t\telem.addEventListener('click', () => {\n\t\t\tBem.setState(node, 'open', false);\n\t\t\topened = false;\n\t\t});\n\t});\n}\ndocument.querySelectorAll('.partial-popup').forEach(popup => popupPartial(popup));\n\n// ------------------------------------------------------------------------------------------------\n\n/**\n * @param {HTMLElement} node\n */\nfunction burgerMenuBackgroundElement(node) {\n\tnode.addEventListener('click', () => setBurgerMenuState(false));\n}\nburgerMenuBackgroundElement(document.querySelector('.partial-burger-menu__background'));\n\n// ------------------------------------------------------------------------------------------------\n\n/**\n * @param {HTMLFormElement} form\n */\nfunction formValidationForGlobalForms(form) {\n\tif (form.querySelector('button[type=\"submit\"]')) {\n\t\tstartFormValidation(form);\n\t}\n}\ndocument.querySelectorAll('form').forEach(form => formValidationForGlobalForms(form));\n\n// ------------------------------------------------------------------------------------------------\n\n/**\n * @param {HTMLElement} node\n */\nfunction cookieConsent(node) {\n\tif(!node) return;\n\n\tBem.element(node, 'btn').addEventListener('click', () => {\n\t\tdocument.cookie = 'acceptedCookies=true';\n\t\tnode.style.display = 'none';\n\t});\n}\ncookieConsent(document.querySelector('.partial-cookie-consent'));\n\n// GLOBAL_CALLS -----------------------------------------------------------------------------------\n\nautoAdjustFontSize(document.body);\n\n// ------------------------------------------------------------------------------------------------\n","window.Bem = {\n\n    /**\n     * @param {Element} node\n     * @returns {string}\n     */\n    bemClass(node) {\n        if (node.classList.length === 1) {\n            return node.classList[0];\n        } else {\n            for (let i = 0; i < node.classList.length; i++) {\n                if (!node.classList[i].includes('--')) {\n                    return node.classList[i];\n                }\n            }\n            return undefined;\n        }\n    },\n\n    /**\n     * @param {Element} node\n     * @param {string} element\n     * @returns {Element}\n     */\n    element(node, element) {\n        const bemClass = Bem.bemClass(node);\n        return node.querySelector(`.${bemClass}__${element}`);\n    },\n\n\t/**\n\t * @param {Element} node\n\t * @param {string} element\n\t * @returns {NodeList<HTMLElement>}\n\t */\n\telements(node, element) {\n\t\tconst bemClass = Bem.bemClass(node);\n\t\treturn node.querySelectorAll(`.${bemClass}__${element}`);\n\t},\n\n    /**\n     * @param {Element} node\n     * @param {string} state\n     * @param {boolean} active\n     */\n    setState(node, state, active) {\n        if (active) {\n            node.classList.add(`is-${state}`);\n        } else {\n            node.classList.remove(`is-${state}`);\n        }\n    },\n\n    /**\n     * @param {Element} node\n     * @param {string} state\n     * @returns {boolean}\n     */\n    hasState(node, state) {\n        return node.classList.contains(`is-${state}`);\n    },\n\n    /**\n     * @param {Element} node\n     * @param {string} state\n     */\n    toggleState(node, state) {\n        node.classList.toggle(`is-${state}`);\n    },\n\n    /**\n     * @param {Element} node\n     * @param {string} modifier\n     * @returns {boolean}\n     */\n    hasModifier(node, modifier) {\n        const bemClass = Bem.bemClass(node);\n        return node.classList.contains(`${bemClass}--${modifier}`);\n    },\n\n    /**\n     * @param {Element} node\n     * @param {string} data\n     * @returns {string}\n     */\n    data(node, data) {\n        return node.getAttribute(`data-${data}`);\n    },\n\n    /**\n     * @param {Element} node\n     * @param {string} data\n     * @returns {boolean}\n     */\n    hasData(node, data) {\n        return node.hasAttribute(`data-${data}`);\n    }\n};\n","/**\n * @param {boolean?} open toggle if undefined\n */\nwindow.setBurgerMenuState = function (open) {\n\tconst burgerMenuButton = document.querySelector('.partial-site-header__burger-menu');\n\tconst burgerMenu = document.querySelector('.partial-burger-menu');\n\tconst burgerMenuBackground = document.querySelector('.partial-burger-menu__background');\n\tif (open !== undefined) {\n\t\tBem.setState(burgerMenu, 'open', open);\n\t\tBem.setState(burgerMenuBackground, 'open', open);\n\t\tBem.setState(burgerMenuButton, 'open', open);\n\t} else {\n\t\topen = !Bem.hasState(burgerMenu, 'open');\n\t\tBem.setState(burgerMenu, 'open', open);\n\t\tBem.setState(burgerMenuBackground, 'open', open);\n\t\tBem.setState(burgerMenuButton, 'open', open);\n\t}\n};\n\n/**\n * @param {Function} func\n * @param {number} debounce\n * @return {Function}\n */\nwindow.debounceFunction = function (func, debounce) {\n\tlet timeout;\n\n\treturn function() {\n\t\tconst context = this;\n\t\tconst args = arguments;\n\n\t\tconst later = function() {\n\t\t\ttimeout = null;\n\t\t\tfunc.apply(context, args);\n\t\t};\n\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(later, debounce);\n\t};\n};\n\n/**\n *\n * @param {HTMLFormElement} formElement\n */\nwindow.startFormValidation = function (formElement) {\n\tconst validationFunctions = {\n\t\tisNotEmpty: value => value !== undefined && value !== null && value !== '',\n\t\tminLength: (value, valData) => value.length >= Number(valData),\n\t\tmaxLength: (value, valData) => value.length <= Number(valData),\n\t\tisEmail: value => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value),\n\t\tmatches: (value, valData) => new RegExp(valData).test(value),\n\t\tmatchesProperty: (value, valData, elements) => elements.namedItem(valData).value === value,\n\t\tmustChange: (value, valData) => value !== valData\n\t};\n\n\tconst submitButton = formElement.querySelector('button[type=\"submit\"]');\n\tconst formElements = formElement.elements;\n\n\tconst formErrorConfig = generateFormErrorConfig(formElements);\n\n\tfor (const elementErrorConfig of formErrorConfig) {\n\t\tupdateElementState(elementErrorConfig, Bem.hasState(elementErrorConfig.formContainer, 'invalid'));\n\n\t\telementErrorConfig.element.addEventListener('input', () => {\n\t\t\telementErrorConfig.touched = true;\n\t\t\tupdateElementState(elementErrorConfig);\n\t\t});\n\t}\n\n\tfunction updateElementState(elementErrorConfig, defaultInvalid) {\n\t\telementErrorConfig.valid = true;\n\t\telementErrorConfig.errors.forEach(error => {\n\t\t\tconst isValid = validationFunctions[error.errorName](elementErrorConfig.element.value, error.valData, formElements);\n\t\t\tif (!isValid) elementErrorConfig.valid = false;\n\t\t\tBem.setState(error.errorMessage, 'shown', !isValid && elementErrorConfig.touched);\n\t\t});\n\t\tBem.setState(elementErrorConfig.formContainer, 'invalid', defaultInvalid || !elementErrorConfig.valid && elementErrorConfig.touched);\n\t\tsubmitButton.disabled = !formErrorConfig.every(elemErrConf => elemErrConf.valid);\n\t}\n\n\t/**\n\t *\n\t * @param {HTMLFormControlsCollection} elements\n\t */\n\tfunction generateFormErrorConfig(elements) {\n\t\tconst config = [];\n\n\t\tfor (const element of elements) {\n\t\t\tif (element instanceof HTMLButtonElement) continue;\n\n\t\t\tconst formContainer = element.closest('div[form-container]');\n\n\t\t\tif (!formContainer) continue;\n\n\t\t\tconst elementConfig = {\n\t\t\t\tformContainer: formContainer,\n\t\t\t\telement: element,\n\t\t\t\ttouched: false,\n\t\t\t\tvalid: false,\n\t\t\t\terrors: []\n\t\t\t};\n\t\t\tconst errorMessages = elementConfig.formContainer.querySelector('div[form-errors]').children;\n\t\t\tfor (const errorMessage of errorMessages) {\n\t\t\t\tconst errorName = errorMessage.getAttribute('data-error');\n\n\t\t\t\tif (!(errorName in validationFunctions)) continue;\n\n\t\t\t\telementConfig.errors.push({\n\t\t\t\t\terrorName: errorName,\n\t\t\t\t\tvalData: errorMessage.getAttribute('data-val-data'),\n\t\t\t\t\terrorMessage: errorMessage\n\t\t\t\t});\n\t\t\t}\n\t\t\tconfig.push(elementConfig);\n\t\t}\n\t\treturn config;\n\t}\n};\n\n/**\n * @param {string} popupUrl\n * @param {Element} insertionPoint\n */\nwindow.openDynamicPopup = async function (popupUrl, insertionPoint) {\n\tconst resp = await fetch(popupUrl);\n\tinsertionPoint.innerHTML = await resp.text();\n\tsetupPopupHandling();\n\n\tfunction setupPopupHandling() {\n\t\tconst popupElem = insertionPoint.querySelector('.partial-popup');\n\n\t\tif (popupElem.hasAttribute('data-js')) {\n\t\t\twindow[popupElem.getAttribute('data-js')](popupElem);\n\t\t}\n\n\t\tBem.elements(popupElem, 'close').forEach(elem => {\n\t\t\telem.addEventListener('click', () => {\n\t\t\t\twhile (insertionPoint.firstChild) {\n\t\t\t\t\tinsertionPoint.removeChild(insertionPoint.lastChild);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tconst formElement = popupElem.querySelector('form');\n\t\tif (!formElement) return;\n\n\t\tstartFormValidation(formElement);\n\t\tformElement.addEventListener('submit', async event => {\n\t\t\tevent.preventDefault();\n\t\t\tif (event.submitter instanceof HTMLButtonElement) {\n\t\t\t\tevent.submitter.disabled = true;\n\t\t\t}\n\n\t\t\tconst submitResp = await fetch(event.submitter.getAttribute('formaction') ?? formElement.action, {\n\t\t\t\tmethod: formElement.method,\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t\t\t\t},\n\t\t\t\tredirect: 'follow',\n\t\t\t\tbody: new URLSearchParams(new FormData(formElement))\n\t\t\t});\n\t\t\tif (submitResp.redirected) {\n\t\t\t\tinsertionPoint.innerHTML = await submitResp.text();\n\t\t\t\tsetupPopupHandling();\n\t\t\t} else {\n\t\t\t\tlocation.reload();\n\t\t\t}\n\t\t});\n\t}\n\n};\n\n/**\n * @param {Element} contextToCheck\n */\nwindow.autoAdjustFontSize = function (contextToCheck) {\n\tcontextToCheck.querySelectorAll('[auto-font-size]').forEach(node => {\n\t\tconst desiredFontWidth = Number(node.getAttribute('auto-font-size'));\n\t\tconst style = window.getComputedStyle(node);\n\t\tconst originalWidth = Number(style.fontSize.replace('px', ''));\n\t\tconst textWidth = getTextWidth(node.innerText, style.font);\n\t\tconst adjustedWidth = originalWidth * (desiredFontWidth / textWidth);\n\n\t\tif (adjustedWidth < originalWidth) {\n\t\t\tnode.style.fontSize = adjustedWidth + 'px';\n\t\t}\n\n\t});\n\n\tfunction getTextWidth(text, font) {\n\t\tif (!window.__autoFontSizeCanvas__) {\n\t\t\twindow.__autoFontSizeCanvas__ = document.createElement('canvas');\n\t\t}\n\t\tconst context2D = window.__autoFontSizeCanvas__.getContext('2d');\n\t\tcontext2D.font = font ?? window.getComputedStyle(this.document.body).font;\n\t\treturn context2D.measureText(text).width;\n\t}\n};\n"]}